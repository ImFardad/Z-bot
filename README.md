# 🤖 Z-Bot: ربات بقا در آخرالزمان زامبی (Node.js + Vue.js)

این پروژه یک ربات تلگرام است که با استفاده از Node.js و مدل هوش مصنوعی Gemini گوگل ساخته شده است. این ربات دارای یک **مینی اپ (Mini App)** داخلی است که با **Vue.js** توسعه داده شده و تجربه کاربری مدرن و گرافیکی را برای مدیریت آیتم‌ها و تعامل با ربات فراهم می‌کند.

ربات، کاربران را در سناریوهای واقع‌گرایانه بقا در دنیای زامبی‌زده قرار می‌دهد و راه حل‌های آن‌ها را بر اساس خلاقیت و کارآمدی ارزیابی می‌کند.

---

## قابلیت‌ها

- **🎮 رابط کاربری مدرن:** استفاده از **مینی اپ تلگرام** برای ارائه یک تجربه کاربری غنی و تعاملی.
- **🧟 سناریوهای بقا:** تولید سناریوهای چالش‌برانگیز و واقع‌گرایانه با استفاده از Gemini AI.
- **🧠 ارزیابی هوشمند:** تحلیل و امتیازدهی به راه حل‌های کاربران.
- **🏕️ سیستم پناهگاه:** ایجاد و مدیریت پناهگاه‌های گروهی با خزانه‌داری و منابع مشترک.
- **💰 اقتصاد داخلی:** شامل فروشگاه برای خرید و ارتقا، کوله پشتی با ظرفیت محدود و مدیریت سوخت.
- **☁️ سازگار با Codespaces:** تنظیمات پروژه به صورت خودکار برای اجرا در محیط **GitHub Codespaces** بهینه شده است.

---

## ساختار پروژه

```
z-bot/
├── .env.example
├── .gitignore
├── .prettierrc.json
├── README.md
├── bot.js
├── config.js
├── eslint.config.js
├── index.js
├── package-lock.json
├── package.json
├── .git/                     (پوشه گیت)
├── .husky/                   (پوشه هوک‌های گیت)
│   ├── _/
│   └── pre-commit
├── data/
│   └── locations.json
├── db/
│   ├── DailyPurchase.js
│   ├── Shelter.js
│   ├── ShopItem.js
│   ├── User.js
│   ├── UserPossibleShelter.js
│   ├── UserQuestionHistory.js
│   └── database.js
├── handlers/
│   ├── backpackHandler.js
│   ├── helpHandler.js
│   ├── menuHandler.js
│   ├── shelterCreationHandler.js
│   ├── shelterHandler.js
│   ├── shelterManagerHandler.js
│   ├── shopHandler.js
│   ├── startHandler.js
│   └── zombieHandler.js
├── iran/
│   ├── cities.json
│   └── provinces.json
├── keyboards/
│   └── inlineKeyboards.js
├── mini-app/                 (پروژه مینی اپ)
│   ├── .gitignore
│   ├── README.md
│   ├── index.html
│   ├── jsconfig.json
│   ├── package.json
│   ├── public/
│   │   └── favicon.ico
│   ├── src/
│   │   ├── App.vue
│   │   ├── main.js
│   │   ├── assets/
│   │   └── components/
│   └── vite.config.js
├── services/
│   └── geminiService.js
└── utils/
    └── progressBar.js
```

---

## نحوه اجرا (توسعه)

### روش ۱: GitHub Codespaces (پیشنهادی)

این ساده‌ترین و سریع‌ترین روش برای اجرای پروژه است و نیازی به `ngrok` یا تنظیمات پیچیده ندارد.

1.  پروژه را در یک Codespace باز کنید.
2.  یک ترمینال جدید باز کنید. شما به **دو ترمینال** نیاز خواهید داشت.
3.  **در ترمینال اول،** ربات را اجرا کنید:
    ```sh
    npm run dev
    ```
4.  **در ترمینال دوم،** سرور توسعه مینی اپ را اجرا کنید:
    ```sh
    cd mini-app
    npm run dev
    ```

پروژه به صورت خودکار پورت‌ها را به اینترنت متصل کرده و ربات آدرس صحیح مینی اپ را تشخیص می‌دهد.

### روش ۲: اجرای لوکال

اگر می‌خواهید پروژه را روی کامپیوتر خود اجرا کنید، مراحل زیر را دنبال کنید:

1.  **راه‌اندازی مینی اپ:**
    - در یک ترمینال، به پوشه `mini-app` بروید و دستور `npm run dev` را اجرا کنید. سرور معمولاً روی پورت `8081` اجرا می‌شود.

2.  **راه‌اندازی `ngrok`:**
    - `ngrok` را روی سیستم خود نصب کنید.
    - در یک ترمینال جدید، دستور زیر را برای ساخت تونل به پورت مینی اپ اجرا کنید:
      ```sh
      ngrok http 8081
      ```
    - آدرس `https://...` که `ngrok` به شما می‌دهد را کپی کنید.

3.  **تنظیم ربات:**
    - یک فایل `.env` در ریشه پروژه بسازید (می‌توانید از `.env.example` کپی کنید).
    - آدرس `ngrok` را در متغیر `MINI_APP_URL` قرار دهید.
      ```
      MINI_APP_URL="httpsIS_YOUR_NGROK_URL"
      ```
    - توکن ربات و سایر متغیرها را نیز در این فایل تنظیم کنید.

4.  **اجرای ربات:**
    - در یک ترمینال دیگر، ربات را اجرا کنید:
      ```sh
      npm run dev
      ```

---

## دستورات اصلی ربات

- `/start`: برای ثبت نام و شروع کار با ربات در چت خصوصی.
- `/shelter`: برای ساخت یا مشاهده اطلاعات پناهگاه در گروه.
- `/manage_shelter`: (فقط در گروه پناهگاه) برای باز کردن منوی مدیریت داخلی پناهگاه.

در منوی اصلی، دکمه **"🎮 Mini App"** برنامه وب داخلی را باز می‌کند.